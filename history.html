<script>
/**
 * レッスン詳細モーダルを表示する関数
 * * 機能:
 * - 選択されたレッスンの詳細情報をHTMLとして生成し、モーダル内に注入する。
 * - 2025-12-18 改修: 数字のブランドフォント化、各項目の枠線装飾を追加。
 * * @param {Object} lesson - レッスンデータオブジェクト (date, lessonNo, achievement, feedback, homework等を含む)
 */
function showLessonDetail(lesson) {
    // 開発用ログ: 関数呼び出しとデータ確認
    console.log('[UI] showLessonDetail fired. Lesson Data:', lesson);

    try {
        // DOM要素の取得
        const modal = document.getElementById('lessonModal');
        const modalBody = document.getElementById('modalBody');

        // 要素が存在しない場合はエラーログを出力して終了（堅牢性確保）
        if (!modal || !modalBody) {
            console.error('[UI Error] Critical: Modal elements (lessonModal or modalBody) not found in DOM.');
            return;
        }

        // 日付フォーマットの生成 (YYYY/MM/DD形式を想定)
        // データ欠損時は空文字でフォールバック
        const dateStr = lesson.date ? new Date(lesson.date).toLocaleDateString('ja-JP') : 'Date Unknown';

        // HTML生成
        // NOTE: デザイン要件に基づき、各セクションを専用クラス(.modal-box-*)でラップ
        modalBody.innerHTML = `
            <div style="text-align: center; margin-bottom: 15px;">
                <h3 class="modal-number-text" style="font-size: 1.5rem; margin: 0;">
                    Lesson ${lesson.lessonNo}
                </h3>
                <p class="modal-number-text" style="color: #666; margin-top: 5px;">
                    ${dateStr}
                </p>
            </div>

            <div class="modal-box-achievement">
                <h4 style="color: var(--color-sub-deep-ocean); margin-top: 0;">Achievement</h4>
                <p>${lesson.achievement || 'なし'}</p>
            </div>

            <div class="modal-box-ocean">
                <h4 style="color: var(--color-sub-deep-ocean); margin-top: 0;">Feedback</h4>
                <p>${lesson.feedback || 'なし'}</p>
            </div>

            <div class="modal-box-ocean">
                <h4 style="color: var(--color-sub-deep-ocean); margin-top: 0;">Homework</h4>
                <p>${lesson.homework || 'なし'}</p>
            </div>
        `;

        // モーダルの表示
        modal.style.display = 'block';
        console.log('[UI] Modal rendered successfully.');

    } catch (error) {
        // 予期せぬエラー（DOM操作失敗やデータ型不整合など）の捕捉
        console.error('[UI Critical] Failed to render lesson detail modal:', error);
        alert('詳細画面の表示中にエラーが発生しました。管理者に連絡してください。');
    }
}
</script>
